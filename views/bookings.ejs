<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <%- include('partials/navbar') %>

    <div class="container py-5">
      <div class="row">
        <div class="col-md-12">

          <h1 class="h3 text-primary fw-bold mb-4">My Bookings</h1>

          <% if (messages && messages.length > 0) { %>
            <div class="alert alert-success border-0 rounded-3 mb-4">
              <% messages.forEach(function(message) { %>
                <p class="mb-0"><i class="bi bi-check-circle-fill me-2"></i><%= message %></p>
              <% }); %>
            </div>
          <% } %>

          <% if (typeof bookings !== 'undefined' && bookings.length > 0) { %>
            <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
              <% bookings.forEach((booking, index) => { 
                const headerColors = ['bg-primary', 'bg-success', 'bg-warning'];
                const headerClass = headerColors[index % headerColors.length];
              %>
                <div class="col">
                  <div class="card h-100 border-0 shadow">
                    <div class="card-header text-white <%= headerClass %> fw-semibold">
                      <%= booking.class_name %>
                    </div>
                    <div class="card-body">
                      <p><strong>Booking Date:</strong> <%= new Date(booking.booking_date).toLocaleDateString() %></p>
                      <p><strong>Status:</strong> <%= booking.status %></p>
                      <a href="/bookings/<%= booking.booking_id %>" class="btn btn-outline-info btn-sm me-2">View</a>
                      <a href="/bookings/<%= booking.booking_id %>/cancel" class="btn btn-outline-danger btn-sm">Cancel</a>
                    </div>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } else { %>
            <div class="alert alert-info bg-secondary text-light border-0 mb-5">No bookings found.</div>
          <% } %>

          <h2 class="h4 text-primary fw-bold mb-4">Available Classes to Book</h2>

          <% if (typeof classes !== 'undefined' && classes.length > 0) { %>
            <div class="row row-cols-1 row-cols-md-3 g-4">
              <% classes.forEach(c => { %>
                <div class="col">
                  <div class="card bg-dark text-light h-100 border-secondary shadow-sm">
                    <div class="card-body">
                      <h5 class="card-title"><%= c.class_name %></h5>
                      <p class="card-text">Starts at: <%= new Date(c.class_start_time).toLocaleString() %></p>
                      <form action="/bookings/book" method="POST">
                        <input type="hidden" name="member_id" value="1"> 
                        <input type="hidden" name="class_id" value="<%= c.class_id %>">
                        <button type="submit" class="btn btn-outline-primary btn-sm">Book Now</button>
                      </form>
                    </div>
                  </div>
                </div>
              <% }) %>
            </div>
          <% } else { %>
            <div class="alert alert-info bg-secondary text-light border-0">No classes available.</div>
          <% } %>

        </div>
      </div>
    </div>
  </body>
</html>
